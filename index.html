<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Generador de Recetas con IA</title>
    <!-- Incluye Typewriter.js y Axios directamente aquí -->
    <script src="https://unpkg.com/typewriter-effect@latest/dist/core.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
      /* --- Estilos CSS (src/style.css) --- */
      body {
        background-color: #fcf8f3; /* Un crema suave y cálido */
        font-family: "Inter", Helvetica, Arial, sans-serif; /* Fuente Inter para un look moderno */
        line-height: 1.6;
        color: #333; /* Texto oscuro para legibilidad */
      }

      a {
        color: #a52a2a; /* Marrón rojizo, como el del café o el vino */
        text-decoration: none;
      }

      a:hover {
        text-decoration: underline;
      }

      .container {
        margin: 80px auto; /* Reducido el margen superior */
        max-width: 700px; /* Aumentado un poco el ancho máximo */
        padding: 20px; /* Añadido padding para pantallas más pequeñas */
      }

      header {
        margin-bottom: 40px;
      }

      h1 {
        text-align: center;
        font-weight: 900; /* Más peso para el título */
        font-size: 44px; /* Tamaño de fuente ligeramente más grande */
        line-height: 1.2;
        color: #5a2d0c; /* Un marrón profundo, como el chocolate o el café */
        margin-bottom: 20px;
      }

      .form-container {
        background-color: #ffffff; /* Fondo blanco para el formulario */
        border-radius: 15px; /* Bordes más redondeados */
        box-shadow: 0px 10px 30px rgba(0, 0, 0, 0.08); /* Sombra suave */
        padding: 30px;
        display: flex;
        flex-direction: column; /* Cambiado a columna para mejor responsividad */
        align-items: center;
        margin-bottom: 30px;
      }

      form {
        width: 100%;
        display: flex;
        flex-wrap: wrap; /* Permite que los elementos se envuelvan en pantallas pequeñas */
        gap: 10px; /* Espacio entre elementos del formulario */
      }

      .instructions {
        flex-grow: 1; /* Permite que ocupe el espacio disponible */
        padding: 18px 25px;
        border: 1px solid #d3baba; /* Borde más suave */
        font-size: 17px;
        border-radius: 30px;
        line-height: 22px;
        color: #333;
      }

      .submit-button {
        background: #cd7f32; /* Color naranja/marrón que evoca especias o pan */
        color: white;
        border: none;
        width: auto; /* Ancho automático basado en el contenido */
        min-width: 150px; /* Ancho mínimo para el botón */
        font-size: 18px;
        border-radius: 30px;
        padding: 16px 28px;
        cursor: pointer;
        transition: background 0.3s ease; /* Transición suave para el hover */
      }

      .submit-button:hover {
        background: #b8621d; /* Un tono más oscuro al pasar el ratón */
      }

      .hint {
        font-size: 14px;
        opacity: 0.7;
        text-align: center;
        margin-top: 15px; /* Espacio sobre la pista */
      }

      .recipe {
        font-size: 17px;
        background-color: #ffffff; /* Fondo blanco para la receta */
        padding: 30px;
        line-height: 1.8;
        border-left: 5px solid #cd7f32; /* Borde más grueso y del color principal */
        box-shadow: 0px 8px 20px rgba(0, 0, 0, 0.05); /* Sombra más pronunciada */
        border-radius: 10px;
        margin-top: 40px; /* Espacio superior */
      }

      .recipe h3 {
          font-size: 28px;
          color: #5a2d0c;
          margin-bottom: 15px;
      }

      .recipe ul, .recipe ol {
          margin-bottom: 20px;
          padding-left: 25px;
      }

      .recipe li {
          margin-bottom: 8px;
      }

      .recipe strong {
          color: #a52a2a; /* Color para la firma */
      }

      .generating {
        text-align: center;
        font-size: 20px;
        color: #a52a2a;
        opacity: 0.8;
        animation: pulse 1.5s infinite; /* Animación de pulsación */
      }

      @keyframes pulse {
        0% { opacity: 0.8; }
        50% { opacity: 1; }
        100% { opacity: 0.8; }
      }

      footer {
        text-align: center;
        font-size: 14px;
        margin-top: 40px;
        opacity: 0.9;
      }

      /* Responsive adjustments */
      @media (max-width: 600px) {
        h1 {
          font-size: 36px;
        }

        .instructions, .submit-button {
          width: 100%;
          margin-left: 0;
        }

        form {
          flex-direction: column;
          gap: 15px;
        }

        .container {
          margin: 40px auto;
          padding: 15px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <h1>Generador de Recetas con IA</h1>
      </header>

      <main>
        <div class="form-container">
          <form id="recipe-generator-form">
            <input
              type="text"
              placeholder="Ingresa ingredientes o tipo de cocina..."
              autofocus
              required
              autocomplete="off"
              class="instructions"
            />
            <input type="submit" class="submit-button" id="user-instructions" value="Generar Receta" />
          </form>
          <div class="hint">Ej: Tomate, Queso, Pollo, Italiana, Vegana</div>
        </div>
        <div class="recipe hidden" id="recipe"></div>
      </main>

      <footer>
        Este proyecto de IA fue codificado por
        <a href="https://www.linkedin.com/in/alecanclini/" target="_blank"
          >Alejandra Canclini</a
        >
        y es
        <a href="https://github.com/malecanclini" target="_blank"
          >de código abierto en Github</a
        >
        y está
        <a
          href="https://app.netlify.com/teams/malecanclini/sites"
          target="_blank"
          >alojado en Netlify</a
        >
      </footer>
    </div>

    <script>
      /* --- Código JavaScript (src/index.js) --- */
      function displayRecipe(response) {
        // Selecciona el elemento HTML donde se mostrará la receta
        let recipeElement = document.querySelector("#recipe");
        // Borra cualquier contenido previo en el elemento de la receta
        recipeElement.innerHTML = "";

        // Utiliza Typewriter.js para mostrar la respuesta de la IA de forma animada
        new Typewriter("#recipe", {
          strings: response.data.answer, // El texto de la receta generada por la IA
          autoStart: true, // Inicia la animación automáticamente
          delay: 1, // Retraso entre caracteres para el efecto de escritura
          cursor: "", // Oculta el cursor al finalizar la escritura
        });
      }

      // Clave API para la llamada al servicio de IA (mantén tu clave aquí)
      let apiKey = "4c2d34edtb05a9b0ao32170dd17e08f4"; // ¡Asegúrate de que esta clave sea válida!
      // URL base de la API de SheCodes AI
      let apiURL =
        "https://api.shecodes.io/ai/v1/generate?prompt={prompt}&context={context}&key={key}";

      function generateRecipe(event) {
        event.preventDefault(); // Evita que el formulario se envíe de forma predeterminada

        // Obtiene el valor del campo de entrada del usuario (ingredientes o tipo de cocina)
        let instructionsInput = document.querySelector(".instructions");
        // Crea el prompt para la IA, pidiéndole una receta basada en la entrada del usuario
        let prompt = `Genera una receta para "${instructionsInput.value}"`;
        // Define el contexto para la IA, indicándole que actúe como un chef experto y cómo formatear la respuesta
        let context =
          "Eres un chef profesional y un experto en recetas. Tu misión es generar una receta simple y deliciosa basada en la entrada del usuario. La receta debe incluir un título claro (usando <h3>), una lista de ingredientes (usando <ul> con <li> para cada ingrediente), y pasos de instrucción claros (usando <ol> con <li> para cada paso). Asegúrate de que cada ingrediente y cada paso de instrucción estén en su propia línea. Al final de la receta, firma con 'SheCodes AI Recipes' dentro de un elemento <strong>, y NO al principio del texto.";
        // Crea el objeto de parámetros para la solicitud a la API
        let params = {
          prompt: prompt,
          context: context,
          key: apiKey,
        };

        // Selecciona el elemento de la receta y lo hace visible
        let recipeElement = document.querySelector("#recipe");
        recipeElement.classList.remove("hidden");
        // Muestra un mensaje de carga mientras se genera la receta
        recipeElement.innerHTML = `<div class="generating">⏳ Generando una receta para ${instructionsInput.value}...</div>`;

        // Realiza la llamada a la API de SheCodes AI
        axios
          .get(apiURL, { params })
          .then((response) => {
            // Si la llamada es exitosa, muestra la receta generada
            displayRecipe(response);
          })
          .catch((error) => {
            // Si hay un error, lo registra en la consola y muestra un mensaje al usuario
            console.error("Error generando la receta:", error);
            recipeElement.innerHTML =
              "Error generando la receta. Por favor, inténtalo de nuevo.";
          });
      }

      // Selecciona el formulario y añade un 'event listener' para cuando se envíe
      let recipeFormElement = document.querySelector("#recipe-generator-form");
      if (recipeFormElement) { // Verifica si el elemento existe antes de añadir el listener
          recipeFormElement.addEventListener("submit", generateRecipe);
      } else {
          console.error("El formulario con ID 'recipe-generator-form' no fue encontrado.");
      }
    </script>
  </body>
</html>